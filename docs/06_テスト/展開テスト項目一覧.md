# 展開テスト項目一覧

## 目次
- [テストケースID体系](#テストケースid体系)
- [単一PC展開テストケース](#単一pc展開テストケース)
- [同時展開テストケース](#同時展開テストケース)
- [エラーケーステスト](#エラーケーステスト)
- [セキュリティテスト](#セキュリティテスト)
- [パフォーマンステスト](#パフォーマンステスト)
- [テスト結果記録シート](#テスト結果記録シート)

---

## テストケースID体系

| プレフィックス | カテゴリ | 範囲 |
|--------------|---------|------|
| TC-DEPLOY-00X | 単一PC展開 | 001-010 |
| TC-DEPLOY-01X | 同時展開 | 011-015 |
| TC-DEPLOY-02X | エラーケース | 021-030 |
| TC-DEPLOY-03X | セキュリティ | 031-035 |
| TC-DEPLOY-04X | パフォーマンス | 041-045 |

---

## 単一PC展開テストケース

### TC-DEPLOY-001: PXEブート正常起動

**テスト項目**: PXEブート経由でClonezillaメニューが正常に表示される

**事前条件**:
- DRBLサーバが起動している
- テストPCがDRBLサーバと同一ネットワークに接続されている
- テストPCのBIOS設定でネットワークブートが有効

**テスト手順**:
1. テストPCの電源を投入
2. BIOSでネットワークブート（PXE）を選択
3. DHCPアドレス取得を確認
4. TFTPブート開始を確認
5. Clonezillaメニュー画面が表示されることを確認

**期待結果**:
- DHCP IPアドレス取得成功（例: 192.168.1.100）
- "Clonezilla live" メニューが表示される
- ネットワークブートエラーが発生しない

**実施日**: ___________
**結果**: □ 成功 □ 失敗
**備考**: ___________________________________________

---

### TC-DEPLOY-002: Clonezillaイメージ展開成功

**テスト項目**: マスターイメージがテストPCに正常に展開される

**事前条件**:
- TC-DEPLOY-001が成功
- DRBLサーバの `/home/partimag/` にマスターイメージが存在
- テストPCディスク容量が十分（最低128GB）

**テスト手順**:
1. Clonezillaメニューから "device-image" を選択
2. "Beginner mode" を選択
3. "restoredisk" を選択
4. マスターイメージ（例: win11-master-20251116）を選択
5. ターゲットディスク（例: /dev/sda）を選択
6. 展開実行を確認

**期待結果**:
- イメージ展開が完了（進捗100%）
- エラーメッセージが表示されない
- 展開完了後、自動再起動が行われる
- 展開時間: 15-25分以内

**実施日**: ___________
**結果**: □ 成功 □ 失敗
**備考**: ___________________________________________

---

### TC-DEPLOY-003: Windows初回起動確認

**テスト項目**: イメージ展開後、Windowsが正常に初回起動する

**事前条件**:
- TC-DEPLOY-002が成功
- unattend.xmlが正しく適用されている

**テスト手順**:
1. Clonezilla展開完了後の自動再起動を待機
2. Windows起動画面を確認
3. OOBE（Out-of-Box Experience）スキップを確認
4. 自動ログオンが実行されることを確認
5. デスクトップが表示されることを確認

**期待結果**:
- Windows起動エラーが発生しない
- OOBE（初期設定画面）が表示されず自動スキップ
- 管理者アカウントで自動ログオン成功
- デスクトップ表示まで5分以内

**実施日**: ___________
**結果**: □ 成功 □ 失敗
**備考**: ___________________________________________

---

### TC-DEPLOY-004: Serial番号取得成功

**テスト項目**: PowerShellスクリプトがBIOS Serial番号を正常に取得する

**事前条件**:
- TC-DEPLOY-003が成功
- setup.ps1が自動起動に登録されている

**テスト手順**:
1. デスクトップ表示後、PowerShellログを確認
2. `Get-CimInstance Win32_BIOS | Select-Object SerialNumber` を手動実行
3. ログファイル（`C:\SetupLogs\serial.log`）を確認

**期待結果**:
- Serial番号が取得される（例: ABC123456789）
- Serial番号が空でない
- ログファイルにSerial番号が記録される

**実施日**: ___________
**結果**: □ 成功 □ 失敗
**備考**: ___________________________________________

---

### TC-DEPLOY-005: API呼び出し成功

**テスト項目**: DRBLサーバのAPIにSerial番号を送信し、PC名とODJパスを取得する

**事前条件**:
- TC-DEPLOY-004が成功
- DRBLサーバのFlaskアプリが起動している
- Serial番号がpc_masterテーブルに登録されている

**テスト手順**:
1. PowerShellログを確認
2. APIリクエスト: `GET http://192.168.1.10:5000/api/pcinfo?serial=ABC123456789`
3. APIレスポンスを確認

**期待結果**:
- HTTPステータス 200 OK
- レスポンス例:
  ```json
  {
    "pcname": "20251116M",
    "odj_path": "/srv/odj/20251116M.txt"
  }
  ```
- PC名が取得される
- ODJファイルパスが取得される
- API応答時間: 200ms以内

**実施日**: ___________
**結果**: □ 成功 □ 失敗
**備考**: ___________________________________________

---

### TC-DEPLOY-006: PC名設定成功

**テスト項目**: 取得したPC名がWindowsに正常に設定される

**事前条件**:
- TC-DEPLOY-005が成功
- PC名が YYYYMMDDM 形式（例: 20251116M）

**テスト手順**:
1. PowerShellログでPC名設定処理を確認
2. `Rename-Computer -NewName "20251116M" -Force` 実行ログを確認
3. 再起動後、`hostname` コマンドでPC名を確認

**期待結果**:
- Rename-Computer実行成功
- エラーメッセージなし
- 再起動後、PC名が "20251116M" に変更されている
- イベントログ（System）に PC名変更イベントが記録される

**実施日**: ___________
**結果**: □ 成功 □ 失敗
**備考**: ___________________________________________

---

### TC-DEPLOY-007: ODJ適用成功

**テスト項目**: ODJファイルを取得しドメイン参加が正常に完了する

**事前条件**:
- TC-DEPLOY-006が成功
- ODJファイルがDRBLサーバに存在（`/srv/odj/20251116M.txt`）
- Active Directoryドメインコントローラが稼働中

**テスト手順**:
1. ODJファイルをDRBLサーバからダウンロード（SCP or HTTP）
2. `djoin.exe /requestODJ /loadfile "C:\Temp\20251116M.txt" /windowspath %SystemRoot% /localos` 実行
3. 再起動後、ドメイン参加確認: `(Get-WmiObject Win32_ComputerSystem).Domain`

**期待結果**:
- djoin.exe 実行成功（終了コード 0）
- エラーメッセージなし
- 再起動後、ドメイン名が "company.local" に変更
- Active Directoryにコンピュータオブジェクトが作成される

**実施日**: ___________
**結果**: □ 成功 □ 失敗
**備考**: ___________________________________________

---

### TC-DEPLOY-008: Windows Update成功

**テスト項目**: Windows Updateが正常に実行され、最新の更新プログラムが適用される

**事前条件**:
- TC-DEPLOY-007が成功
- インターネット接続が利用可能
- PSWindowsUpdateモジュールがインストール済み

**テスト手順**:
1. `Install-Module PSWindowsUpdate -Force` 実行確認
2. `Get-WindowsUpdate` で利用可能な更新を確認
3. `Install-WindowsUpdate -AcceptAll -AutoReboot` 実行
4. 更新完了まで待機（ループ処理）
5. `Get-WUHistory` で更新履歴を確認

**期待結果**:
- 利用可能な更新プログラムが全てインストールされる
- Windows Update実行中にエラーが発生しない
- 再起動が必要な場合、自動再起動が実行される
- 最終的に利用可能な更新が0件になる
- 更新完了時間: 30-60分以内

**実施日**: ___________
**結果**: □ 成功 □ 失敗
**備考**: ___________________________________________

---

### TC-DEPLOY-009: アプリ導入成功

**テスト項目**: 会社標準アプリケーションが正常にインストールされる

**事前条件**:
- TC-DEPLOY-008が成功
- アプリインストーラがDRBLサーバに配置されている

**テスト手順**:
1. アプリケーションリスト確認:
   - Microsoft 365 Apps
   - セキュリティソフト
   - PDF閲覧ソフト
   - 圧縮解凍ツール
2. 各アプリのサイレントインストール実行
3. インストール後、アプリ一覧で確認: `Get-ItemProperty HKLM:\Software\Microsoft\Windows\CurrentVersion\Uninstall\*`

**期待結果**:
- 全アプリケーションのインストール成功
- インストールエラーが発生しない
- レジストリに各アプリが登録される
- スタートメニューにアプリアイコンが表示される

**実施日**: ___________
**結果**: □ 成功 □ 失敗
**備考**: ___________________________________________

---

### TC-DEPLOY-010: セットアップログ送信成功

**テスト項目**: セットアップ完了ログがDRBL APIに正常に送信される

**事前条件**:
- TC-DEPLOY-009が成功
- DRBLサーバのFlaskアプリが起動中

**テスト手順**:
1. PowerShellログで送信処理を確認
2. APIリクエスト:
   ```json
   POST http://192.168.1.10:5000/api/log
   Body: {
     "serial": "ABC123456789",
     "pcname": "20251116M",
     "status": "completed",
     "timestamp": "2025-11-16 12:33:22",
     "logs": "All setup steps completed successfully"
   }
   ```
3. DRBLサーバのsetup_logsテーブルを確認

**期待結果**:
- HTTPステータス 200 OK
- レスポンス: `{"result": "ok"}`
- setup_logsテーブルにレコードが追加される
- status が "completed" で記録される

**実施日**: ___________
**結果**: □ 成功 □ 失敗
**備考**: ___________________________________________

---

## 同時展開テストケース

### TC-DEPLOY-011: 5台同時展開

**テスト項目**: 5台のPCを同時展開し、全台が正常に完了する

**事前条件**:
- DRBLサーバが5台同時展開に対応している
- 5台のテストPCが準備されている
- ネットワークスイッチが5台以上接続可能

**テスト手順**:
1. 5台のPCを同時にPXEブート
2. Clonezillaマルチキャスト展開を選択
3. 全台の展開進捗を監視
4. 展開完了後、各PCのWindows起動を確認
5. 各PCのセットアップ完了を確認

**期待結果**:
- 5台全てが同時にPXEブート成功
- マルチキャスト展開が正常に動作
- 展開時間: 20-30分以内（単一展開+5-10分）
- 全台がセットアップ完了
- ネットワーク帯域飽和が発生しない

**実施日**: ___________
**結果**: □ 成功 □ 失敗
**備考**: ___________________________________________

---

### TC-DEPLOY-012: 10台同時展開

**テスト項目**: 10台のPCを同時展開し、全台が正常に完了する

**事前条件**:
- DRBLサーバが10台同時展開に対応している
- 10台のテストPCが準備されている
- ネットワーク帯域が十分（Gigabit Ethernet推奨）

**テスト手順**:
1. 10台のPCを同時にPXEブート
2. Clonezillaマルチキャスト展開を選択
3. 全台の展開進捗を監視
4. ネットワークトラフィックを監視（`iftop` or `nload`）
5. 展開完了後、各PCのセットアップ完了を確認

**期待結果**:
- 10台全てが同時にPXEブート成功
- マルチキャスト展開が正常に動作
- 展開時間: 25-35分以内（単一展開+10-15分）
- 全台がセットアップ完了
- ネットワーク帯域使用率: 80%以下

**実施日**: ___________
**結果**: □ 成功 □ 失敗
**備考**: ___________________________________________

---

### TC-DEPLOY-013: 20台同時展開

**テスト項目**: 20台のPCを同時展開し、全台が正常に完了する（最大想定台数）

**事前条件**:
- DRBLサーバが20台同時展開に対応している
- 20台のテストPCが準備されている
- ネットワークスイッチが20台以上接続可能
- DRBLサーバのCPU・メモリが十分

**テスト手順**:
1. 20台のPCを同時にPXEブート
2. Clonezillaマルチキャスト展開を選択
3. 全台の展開進捗を監視
4. DRBLサーバのリソース使用率を監視（`top`, `free -h`）
5. 展開完了後、各PCのセットアップ完了を確認

**期待結果**:
- 20台全てが同時にPXEブート成功
- マルチキャスト展開が正常に動作
- 展開時間: 30-45分以内（単一展開+15-20分）
- 全台がセットアップ完了
- DRBLサーバCPU使用率: 80%以下
- DRBLサーバメモリ使用率: 80%以下

**実施日**: ___________
**結果**: □ 成功 □ 失敗
**備考**: ___________________________________________

---

### TC-DEPLOY-014: ネットワーク負荷確認

**テスト項目**: 同時展開中のネットワーク負荷が許容範囲内である

**事前条件**:
- TC-DEPLOY-013実施中
- ネットワーク監視ツールが準備されている（`iftop`, `nload`, `bmon`）

**テスト手順**:
1. 20台同時展開開始
2. DRBLサーバのネットワークトラフィックを記録
3. スイッチのトラフィック統計を確認
4. パケットロス率を測定
5. 最大帯域使用率を記録

**期待結果**:
- ネットワーク帯域使用率: 80%以下（Gigabit環境で800Mbps以下）
- パケットロス: 1%未満
- マルチキャストパケット配信成功
- ネットワーク遅延: 10ms以下

**実施日**: ___________
**結果**: □ 成功 □ 失敗
**備考**: ___________________________________________

---

### TC-DEPLOY-015: パフォーマンス劣化測定

**テスト項目**: 同時展開台数増加による性能劣化が許容範囲内である

**事前条件**:
- TC-DEPLOY-001, 011, 012, 013のデータが揃っている

**テスト手順**:
1. 展開台数ごとの完了時間を比較:
   - 1台: X分
   - 5台: Y分
   - 10台: Z分
   - 20台: W分
2. 1台あたりの増加時間を算出
3. 性能劣化率を計算

**期待結果**:
- 1台あたりの性能劣化: 20%以内
- 例: 1台15分 → 20台同時で1台あたり18分（20%以内）
- 展開時間が台数に対して線形増加しない
- マルチキャスト効果が確認できる

**実施日**: ___________
**結果**: □ 成功 □ 失敗
**備考**: ___________________________________________

---

## エラーケーステスト

### TC-DEPLOY-021: Serial番号未登録時のエラーハンドリング

**テスト項目**: Serial番号がpc_masterテーブルに未登録の場合、適切にエラー処理される

**事前条件**:
- テストPCのSerial番号がpc_masterテーブルに存在しない
- PowerShellスクリプトが起動している

**テスト手順**:
1. イメージ展開完了後、Windows初回起動
2. Serial番号取得処理を確認
3. API呼び出し: `GET /api/pcinfo?serial=UNREGISTERED123`
4. APIエラーレスポンスを確認
5. PowerShellエラーハンドリング処理を確認

**期待結果**:
- API HTTPステータス: 404 Not Found
- レスポンス: `{"error": "Serial not found"}`
- PowerShellログにエラーメッセージ記録
- 管理GUIにエラー通知送信
- PCは手動介入待機状態になる
- エラーログがDRBLサーバに送信される

**実施日**: ___________
**結果**: □ 成功 □ 失敗
**備考**: ___________________________________________

---

### TC-DEPLOY-022: ODJファイル不在時のエラーハンドリング

**テスト項目**: ODJファイルが存在しない場合、適切にエラー処理される

**事前条件**:
- pc_masterテーブルにレコードは存在
- odj_path に指定されたファイルが実際には存在しない

**テスト手順**:
1. API呼び出しでodj_pathを取得
2. ODJファイルダウンロード試行
3. ファイル不在エラーを確認
4. PowerShellエラーハンドリング処理を確認

**期待結果**:
- HTTPステータス: 404 Not Found（ODJファイルダウンロード時）
- PowerShellログにエラーメッセージ記録
- djoin.exe は実行されない
- エラーログがDRBLサーバに送信される
- 管理GUIにアラート通知

**実施日**: ___________
**結果**: □ 成功 □ 失敗
**備考**: ___________________________________________

---

### TC-DEPLOY-023: API接続失敗時のリトライ

**テスト項目**: DRBL APIに接続できない場合、3回リトライ後にエラー処理される

**事前条件**:
- DRBLサーバが停止している、またはネットワーク切断

**テスト手順**:
1. Windows起動後、API呼び出し試行
2. タイムアウト発生を確認（例: 5秒）
3. リトライ処理を確認（間隔: 10秒）
4. 3回リトライ後のエラー処理を確認

**期待結果**:
- 1回目: タイムアウト → 10秒待機
- 2回目: タイムアウト → 10秒待機
- 3回目: タイムアウト → エラー処理
- PowerShellログに "API retry 1/3", "API retry 2/3", "API retry 3/3" 記録
- 3回失敗後、エラーログローカル保存
- PC名設定をスキップし、一時的なPC名（例: TEMP-ABC123456）を設定

**実施日**: ___________
**結果**: □ 成功 □ 失敗
**備考**: ___________________________________________

---

### TC-DEPLOY-024: ネットワーク切断時の挙動

**テスト項目**: セットアップ途中でネットワークが切断された場合の挙動

**事前条件**:
- セットアップ実行中
- ネットワークケーブルを物理的に抜く

**テスト手順**:
1. PC名設定完了後、ネットワークケーブルを抜く
2. ODJファイルダウンロード試行
3. エラーハンドリングを確認
4. ネットワーク再接続後の挙動を確認

**期待結果**:
- ネットワーク切断検出
- リトライ処理実行（最大3回）
- 失敗後、エラーログローカル保存
- ネットワーク再接続後、再実行可能な状態になる
- 既に完了した処理（PC名設定等）は再実行されない

**実施日**: ___________
**結果**: □ 成功 □ 失敗
**備考**: ___________________________________________

---

### TC-DEPLOY-025: ディスク容量不足時のエラー

**テスト項目**: ディスク容量不足でイメージ展開が失敗する場合のエラー処理

**事前条件**:
- テストPCのディスクサイズがマスターイメージより小さい

**テスト手順**:
1. PXEブート → Clonezilla起動
2. イメージ展開開始
3. ディスク容量不足エラー発生を確認
4. Clonezillaエラーメッセージを確認

**期待結果**:
- Clonezillaエラーメッセージ表示
- イメージ展開が中断される
- エラーログが記録される
- ディスク容量不足が明確に示される

**実施日**: ___________
**結果**: □ 成功 □ 失敗
**備考**: ___________________________________________

---

### TC-DEPLOY-026: djoin.exe 実行失敗時のエラー

**テスト項目**: djoin.exeがエラーで終了した場合のエラー処理

**事前条件**:
- ODJファイルが破損している、または形式が不正

**テスト手順**:
1. 不正なODJファイルを配置
2. djoin.exe実行
3. 終了コード確認（非0）
4. エラーハンドリング処理を確認

**期待結果**:
- djoin.exe 終了コード: 非0（エラー）
- PowerShellログにエラーメッセージ記録
- Windowsイベントログに記録
- エラーログがDRBLサーバに送信される
- ドメイン参加はスキップされる

**実施日**: ___________
**結果**: □ 成功 □ 失敗
**備考**: ___________________________________________

---

### TC-DEPLOY-027: Windows Update失敗時のエラー

**テスト項目**: Windows Updateがエラーで失敗した場合のリトライ処理

**事前条件**:
- インターネット接続が不安定、またはWindows Updateサーバがメンテナンス中

**テスト手順**:
1. `Install-WindowsUpdate -AcceptAll -AutoReboot` 実行
2. エラー発生を確認
3. リトライ処理を確認（最大3回）
4. 最終的なエラー処理を確認

**期待結果**:
- 1回目失敗 → 5分待機 → リトライ
- 2回目失敗 → 5分待機 → リトライ
- 3回目失敗 → エラーログ記録
- PowerShellログに詳細なエラー情報記録
- セットアップ継続（Windows Updateをスキップ）

**実施日**: ___________
**結果**: □ 成功 □ 失敗
**備考**: ___________________________________________

---

### TC-DEPLOY-028: アプリインストール失敗時のエラー

**テスト項目**: 特定のアプリケーションインストールが失敗した場合の処理

**事前条件**:
- アプリインストーラが破損、またはサイレントインストールオプションが不正

**テスト手順**:
1. 不正なインストーラを使用
2. アプリインストール実行
3. 終了コード確認（非0）
4. エラーハンドリング処理を確認

**期待結果**:
- インストール終了コード: 非0（エラー）
- PowerShellログにエラーメッセージ記録
- エラーログがDRBLサーバに送信される
- セットアップ継続（他のアプリインストールを続行）
- 失敗したアプリのみエラーマーク

**実施日**: ___________
**結果**: □ 成功 □ 失敗
**備考**: ___________________________________________

---

### TC-DEPLOY-029: セットアップログ送信失敗

**テスト項目**: セットアップ完了ログ送信が失敗した場合のリトライ処理

**事前条件**:
- DRBLサーバのFlaskアプリが停止している

**テスト手順**:
1. セットアップ完了
2. API `/api/log` への送信試行
3. タイムアウト/エラー発生を確認
4. リトライ処理を確認（最大3回）

**期待結果**:
- 1回目失敗 → 10秒待機 → リトライ
- 2回目失敗 → 10秒待機 → リトライ
- 3回目失敗 → ローカルに保存
- ローカルログファイル: `C:\SetupLogs\failed_log.json`
- 後で手動送信可能な形式で保存

**実施日**: ___________
**結果**: □ 成功 □ 失敗
**備考**: ___________________________________________

---

### TC-DEPLOY-030: 複数エラー同時発生時の挙動

**テスト項目**: 複数のエラーが同時に発生した場合の処理

**事前条件**:
- API接続失敗 + ODJファイル不在 + Windows Update失敗

**テスト手順**:
1. 複数のエラーを意図的に発生させる
2. エラーハンドリング処理を確認
3. 最終的なセットアップ状態を確認

**期待結果**:
- 全てのエラーがログに記録される
- エラー発生順に処理される
- クリティカルエラー（API接続失敗等）で処理中断
- エラーログが詳細に記録される
- 管理者への通知が送信される

**実施日**: ___________
**結果**: □ 成功 □ 失敗
**備考**: ___________________________________________

---

## セキュリティテスト

### TC-DEPLOY-031: ODJファイル権限確認

**テスト項目**: ODJファイルが適切な権限で保存されている

**事前条件**:
- ODJファイルがDRBLサーバに配置されている

**テスト手順**:
1. DRBLサーバにSSH接続
2. ODJファイル権限確認: `ls -l /srv/odj/20251116M.txt`
3. ディレクトリ権限確認: `ls -ld /srv/odj/`

**期待結果**:
- ファイル権限: `-rw------- (600)` または `-rw-r----- (640)`
- ディレクトリ権限: `drwx------ (700)` または `drwxr-x--- (750)`
- 所有者: root または drbl
- 他ユーザーが読み取り不可

**実施日**: ___________
**結果**: □ 成功 □ 失敗
**備考**: ___________________________________________

---

### TC-DEPLOY-032: API認証確認（オプション）

**テスト項目**: API呼び出し時に認証が必要な場合、認証が正しく機能する

**事前条件**:
- Flask APIに認証機能が実装されている（API Key or Bearer Token）

**テスト手順**:
1. 認証なしでAPI呼び出し
2. HTTPステータス 401 Unauthorized を確認
3. 正しい認証情報でAPI呼び出し
4. HTTPステータス 200 OK を確認

**期待結果**:
- 認証なし: HTTPステータス 401
- 不正な認証情報: HTTPステータス 403 Forbidden
- 正しい認証情報: HTTPステータス 200
- API Key漏洩リスクなし

**実施日**: ___________
**結果**: □ 成功 □ 失敗
**備考**: ___________________________________________

---

### TC-DEPLOY-033: PowerShellスクリプト署名検証

**テスト項目**: PowerShellスクリプトがデジタル署名されており、改ざん検知が可能

**事前条件**:
- setup.ps1がデジタル署名されている

**テスト手順**:
1. PowerShell実行ポリシー確認: `Get-ExecutionPolicy`
2. スクリプト署名確認: `Get-AuthenticodeSignature C:\Setup\setup.ps1`
3. スクリプト改ざん後、再実行
4. 署名検証エラー発生を確認

**期待結果**:
- 実行ポリシー: AllSigned or RemoteSigned
- 署名ステータス: Valid
- 改ざん後: 署名ステータス: NotSigned or HashMismatch
- 改ざんスクリプトは実行されない

**実施日**: ___________
**結果**: □ 成功 □ 失敗
**備考**: ___________________________________________

---

### TC-DEPLOY-034: ネットワーク通信暗号化確認

**テスト項目**: API通信がHTTPS（TLS）で暗号化されている（推奨）

**事前条件**:
- DRBLサーバでHTTPSが有効化されている

**テスト手順**:
1. API呼び出し: `https://192.168.1.10:5000/api/pcinfo?serial=ABC123`
2. TLS証明書確認
3. 通信内容がパケットキャプチャで暗号化されていることを確認

**期待結果**:
- HTTPS接続成功
- TLS 1.2 以上使用
- 証明書が有効（自己署名証明書の場合、信頼済みストアに追加）
- パケットキャプチャで平文が確認できない

**実施日**: ___________
**結果**: □ 成功 □ 失敗
**備考**: ___________________________________________

---

### TC-DEPLOY-035: ログファイルセキュリティ

**テスト項目**: ローカルログファイルが適切な権限で保存されている

**事前条件**:
- セットアップログが `C:\SetupLogs\` に保存される

**テスト手順**:
1. ログファイル権限確認: `Get-Acl C:\SetupLogs\`
2. 一般ユーザーでアクセス試行
3. アクセス拒否を確認

**期待結果**:
- ディレクトリ権限: Administrators, SYSTEM のみ
- 一般ユーザー（Users）は読み取り不可
- ログファイルに機密情報（パスワード等）が記録されていない

**実施日**: ___________
**結果**: □ 成功 □ 失敗
**備考**: ___________________________________________

---

## パフォーマンステスト

### TC-DEPLOY-041: イメージ展開速度測定

**テスト項目**: Clonezillaイメージ展開速度が基準値以上である

**事前条件**:
- マスターイメージサイズ: 約50GB
- ネットワーク: Gigabit Ethernet
- 圧縮形式: zstd

**テスト手順**:
1. 単一PC展開開始
2. 展開開始時刻記録
3. 展開完了時刻記録
4. 展開速度算出（MB/s）

**期待結果**:
- 展開時間: 15-25分以内
- 展開速度: 30-50 MB/s 以上
- CPU使用率（DRBLサーバ）: 50%以下
- ネットワーク帯域使用率: 30-50%

**実施日**: ___________
**結果**: □ 成功 □ 失敗
**備考**: ___________________________________________

---

### TC-DEPLOY-042: API応答時間測定

**テスト項目**: DRBL API応答時間が200ms以内である

**事前条件**:
- DRBLサーバが起動している
- pc_masterテーブルに100件以上のレコードが存在

**テスト手順**:
1. API呼び出し: `GET /api/pcinfo?serial=ABC123`
2. 応答時間測定（10回実行）
3. 平均応答時間算出

**期待結果**:
- 平均応答時間: 200ms以内
- 最大応答時間: 500ms以内
- HTTPステータス: 200 OK
- データベースクエリ時間: 50ms以内

**実施日**: ___________
**結果**: □ 成功 □ 失敗
**備考**: ___________________________________________

---

### TC-DEPLOY-043: Windows Update時間測定

**テスト項目**: Windows Updateが60分以内に完了する

**事前条件**:
- マスターイメージが最新（1ヶ月以内）
- インターネット接続が安定

**テスト手順**:
1. Windows Update開始時刻記録
2. 全更新プログラムインストール完了時刻記録
3. 所要時間算出

**期待結果**:
- 所要時間: 60分以内
- インストール更新数: 50個以下
- 再起動回数: 3回以内
- エラー発生なし

**実施日**: ___________
**結果**: □ 成功 □ 失敗
**備考**: ___________________________________________

---

### TC-DEPLOY-044: 全体セットアップ時間測定

**テスト項目**: PXEブートからセットアップ完了まで90分以内

**事前条件**:
- 全自動セットアップ環境

**テスト手順**:
1. PXEブート開始時刻記録
2. セットアップ完了ログ送信時刻記録
3. 全体所要時間算出

**期待結果**:
- 全体所要時間: 60-90分以内
- 内訳:
  - Clonezilla展開: 15-25分
  - Windows初回起動: 5分
  - PC名設定・ODJ適用: 10分
  - Windows Update: 30-60分
  - アプリ導入: 10-20分
- エラー発生による遅延なし

**実施日**: ___________
**結果**: □ 成功 □ 失敗
**備考**: ___________________________________________

---

### TC-DEPLOY-045: DRBLサーバリソース使用率測定

**テスト項目**: 20台同時展開時のDRBLサーバリソース使用率が80%以下

**事前条件**:
- 20台同時展開実施中

**テスト手順**:
1. DRBLサーバでリソース監視開始: `top`, `free -h`, `iftop`
2. 20台同時展開実行
3. 最大CPU使用率記録
4. 最大メモリ使用率記録
5. 最大ネットワーク帯域使用率記録

**期待結果**:
- CPU使用率: 80%以下
- メモリ使用率: 80%以下（最低16GB RAM推奨）
- ネットワーク帯域使用率: 80%以下
- ディスクI/O待機: 20%以下

**実施日**: ___________
**結果**: □ 成功 □ 失敗
**備考**: ___________________________________________

---

## テスト結果記録シート

### 単一PC展開テストケース（TC-DEPLOY-001 ~ 010）

| テストケースID | テスト項目 | 実施日 | 結果 | 備考 |
|---------------|-----------|--------|------|------|
| TC-DEPLOY-001 | PXEブート正常起動 | _______ | □成功 □失敗 | ____________ |
| TC-DEPLOY-002 | Clonezillaイメージ展開成功 | _______ | □成功 □失敗 | ____________ |
| TC-DEPLOY-003 | Windows初回起動確認 | _______ | □成功 □失敗 | ____________ |
| TC-DEPLOY-004 | Serial番号取得成功 | _______ | □成功 □失敗 | ____________ |
| TC-DEPLOY-005 | API呼び出し成功 | _______ | □成功 □失敗 | ____________ |
| TC-DEPLOY-006 | PC名設定成功 | _______ | □成功 □失敗 | ____________ |
| TC-DEPLOY-007 | ODJ適用成功 | _______ | □成功 □失敗 | ____________ |
| TC-DEPLOY-008 | Windows Update成功 | _______ | □成功 □失敗 | ____________ |
| TC-DEPLOY-009 | アプリ導入成功 | _______ | □成功 □失敗 | ____________ |
| TC-DEPLOY-010 | セットアップログ送信成功 | _______ | □成功 □失敗 | ____________ |

### 同時展開テストケース（TC-DEPLOY-011 ~ 015）

| テストケースID | テスト項目 | 実施日 | 結果 | 備考 |
|---------------|-----------|--------|------|------|
| TC-DEPLOY-011 | 5台同時展開 | _______ | □成功 □失敗 | ____________ |
| TC-DEPLOY-012 | 10台同時展開 | _______ | □成功 □失敗 | ____________ |
| TC-DEPLOY-013 | 20台同時展開 | _______ | □成功 □失敗 | ____________ |
| TC-DEPLOY-014 | ネットワーク負荷確認 | _______ | □成功 □失敗 | ____________ |
| TC-DEPLOY-015 | パフォーマンス劣化測定 | _______ | □成功 □失敗 | ____________ |

### エラーケーステスト（TC-DEPLOY-021 ~ 030）

| テストケースID | テスト項目 | 実施日 | 結果 | 備考 |
|---------------|-----------|--------|------|------|
| TC-DEPLOY-021 | Serial番号未登録エラー | _______ | □成功 □失敗 | ____________ |
| TC-DEPLOY-022 | ODJファイル不在エラー | _______ | □成功 □失敗 | ____________ |
| TC-DEPLOY-023 | API接続失敗リトライ | _______ | □成功 □失敗 | ____________ |
| TC-DEPLOY-024 | ネットワーク切断時挙動 | _______ | □成功 □失敗 | ____________ |
| TC-DEPLOY-025 | ディスク容量不足エラー | _______ | □成功 □失敗 | ____________ |
| TC-DEPLOY-026 | djoin実行失敗エラー | _______ | □成功 □失敗 | ____________ |
| TC-DEPLOY-027 | Windows Update失敗リトライ | _______ | □成功 □失敗 | ____________ |
| TC-DEPLOY-028 | アプリインストール失敗 | _______ | □成功 □失敗 | ____________ |
| TC-DEPLOY-029 | セットアップログ送信失敗 | _______ | □成功 □失敗 | ____________ |
| TC-DEPLOY-030 | 複数エラー同時発生 | _______ | □成功 □失敗 | ____________ |

### セキュリティテスト（TC-DEPLOY-031 ~ 035）

| テストケースID | テスト項目 | 実施日 | 結果 | 備考 |
|---------------|-----------|--------|------|------|
| TC-DEPLOY-031 | ODJファイル権限確認 | _______ | □成功 □失敗 | ____________ |
| TC-DEPLOY-032 | API認証確認 | _______ | □成功 □失敗 | ____________ |
| TC-DEPLOY-033 | スクリプト署名検証 | _______ | □成功 □失敗 | ____________ |
| TC-DEPLOY-034 | 通信暗号化確認 | _______ | □成功 □失敗 | ____________ |
| TC-DEPLOY-035 | ログファイルセキュリティ | _______ | □成功 □失敗 | ____________ |

### パフォーマンステスト（TC-DEPLOY-041 ~ 045）

| テストケースID | テスト項目 | 実施日 | 結果 | 測定値 | 基準値 |
|---------------|-----------|--------|------|--------|--------|
| TC-DEPLOY-041 | イメージ展開速度 | _______ | □成功 □失敗 | ___ MB/s | 30-50 MB/s |
| TC-DEPLOY-042 | API応答時間 | _______ | □成功 □失敗 | ___ ms | < 200ms |
| TC-DEPLOY-043 | Windows Update時間 | _______ | □成功 □失敗 | ___ 分 | < 60分 |
| TC-DEPLOY-044 | 全体セットアップ時間 | _______ | □成功 □失敗 | ___ 分 | 60-90分 |
| TC-DEPLOY-045 | サーバリソース使用率 | _______ | □成功 □失敗 | CPU:___% MEM:___% NET:___% | < 80% |

---

## 総合評価

### テスト実施サマリー

- **総テストケース数**: 45
- **実施済みテストケース**: ____ / 45
- **成功**: ____ 件
- **失敗**: ____ 件
- **成功率**: _____%

### 合格基準

- 単一PC展開テスト: 全項目成功（10/10）
- 同時展開テスト: 全項目成功（5/5）
- エラーケーステスト: 80%以上成功（8/10以上）
- セキュリティテスト: 全項目成功（5/5）
- パフォーマンステスト: 全項目基準値以内（5/5）

### 総合判定

□ **合格** - 本番環境展開可能
□ **条件付き合格** - 一部改善後、本番環境展開可能
□ **不合格** - 再テスト必要

### 判定者署名

判定日: __________
判定者: __________
承認者: __________

---

**ドキュメントバージョン**: 1.0
**最終更新日**: 2025-11-17
